!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"dictate",value:function(){}},{key:"result",value:function(){}}])&&r(t.prototype,n),o&&r(t,o),e}();function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._recognition=null,this._initialize(t)}var t,n,r;return t=e,(n=[{key:"_initialize",value:function(e){window.SpeechRecognition=window.webkitSpeechRecognition||window.SpeechRecognition,this._recognition=new SpeechRecognition,this._recognition.language=e.lang?e.lang:void 0,this._recognition.maxAlternatives=e.maxAlternatives?e.maxAlternatives:1}},{key:"dictate",value:function(){this._recognition.start()}},{key:"result",value:function(){var e=this;return new Promise(function(t){e._recognition.onresult=function(e){var n=e.results[0][0].transcript;e.results[0].isFinal&&t(n)}})}},{key:"stop",value:function(){this._recognition.stop()}}])&&i(t.prototype,n),r&&i(t,r),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._speechApi=null,this._setApi(t)}var t,n,r;return t=e,(n=[{key:"_setApi",value:function(e){if(e.W3C)this._speechApi=new u(e.W3C);else{if(!e.GoogleCloudApi)throw new Error("Is not set any global.speechApi configuration");this._speechApi=new o(e.GoogleCloudApi)}}},{key:"dictate",value:function(){this._speechApi.dictate()}},{key:"result",value:function(){return this._speechApi.result()}},{key:"stop",value:function(){this._speechApi.stop()}}])&&a(t.prototype,n),r&&a(t,r),e}();function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parentNode=parent,this._parentKey=t,this._children={},this.data=null,this.isEndOfWord=!1,this.word=null}var t,n,r;return t=e,(n=[{key:"update",value:function(e){this.isEndOfWord=!!e,this.data=e,this.isEndOfWord||(this.word=null)}},{key:"hasChildren",value:function(){return Object.keys(this._children).length>0}},{key:"deleteChild",value:function(e){this.children[e].update(null),this.children[e]._parentNode=null,this.children[e]._parentKey=null,this.children[e].word=null,delete this._children[e]}},{key:"addChild",value:function(e,t){this._children[e]=t}},{key:"hasChild",value:function(e){return!!this._children[e]}},{key:"parent",get:function(){return{key:this._parentKey,node:this._parentNode}}},{key:"children",get:function(){return this._children}}])&&l(t.prototype,n),r&&l(t,r),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._root=new s,this._lastIndex=1}var t,n,r;return t=e,(n=[{key:"insert",value:function(e,t){return this._insertWord(e,t,this._root,0)}},{key:"_insertWord",value:function(e,t,n,r){if(r===e.length)return n.word=e,n.update(t||this._getNextIndex()),!0;var o=e.charAt(r);return n.hasChild(o)||n.addChild(o,new s(n,o)),this._insertWord(e,t,n.children[o],r+1)}},{key:"search",value:function(e){var t=this._searchNode(e,this._root,0);return t?t.data:null}},{key:"_searchNode",value:function(e,t,n){if(n===e.length)return t.isEndOfWord?t:null;var r=e.charAt(n);return t.hasChild(r)?this._searchNode(e,t.children[r],n+1):null}},{key:"delete",value:function(e){var t=this._searchNode(e,this._root,0);return!!t&&(t.hasChildren()?(t.update(null),!0):(this._deleteWord(t),!0))}},{key:"_deleteWord",value:function(e){if(e!==this._root){var t=e.parent;t.node.deleteChild(t.key),t.node.hasChildren()||this._deleteWord(t.node)}}},{key:"update",value:function(e,t){var n=this._searchNode(e,this._root,0);return!!n&&(n.update(t),!0)}},{key:"getDataNode",value:function(e){return this._searchNode(e,this._root,0)}},{key:"getPath",value:function(e){var t=[];t.push(this._root);for(var n=1;n<=e.length;n++)t.push(this._searchNode(e.substring(0,n),this._root,0));return t}},{key:"_getNextIndex",value:function(){return this._lastIndex++}},{key:"root",get:function(){return this._root}}])&&f(t.prototype,n),r&&f(t,r),e}();function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.querySelector=t,this.domElement=this._setDomElement(t),this.phrases=this._setPhrases(n),this.event=n.actions,this.listener=n.listener}var t,n,r;return t=e,(n=[{key:"_setDomElement",value:function(e){var t=document.querySelector(e);if(t)return t;throw new Error("VCL >> Element "+e+" not found on the page.")}},{key:"_setPhrases",value:function(e){if(e.phrases instanceof Array)return this._simplify(e.phrases);throw new Error("VCL >> phrases for "+this.querySelector+" is not configured.")}},{key:"_simplify",value:function(e){var t=e.map(function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()});return Array.prototype.push.apply(e,t),e}}])&&p(t.prototype,n),r&&p(t,r),e}();function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._controlObjects={},this._trie=new h,this.divideControlObjects(t)}var t,n,r;return t=e,(n=[{key:"_unsetGlobalConfig",value:function(e){return e.global?function(e){e.global;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v(e,t,n[t])})}return e}({},d(e,["global"]))}(e):e}},{key:"divideControlObjects",value:function(e){var t=this;Object.keys(this._unsetGlobalConfig(e)).forEach(function(n){t._controlObjects[n]=new y(n,e[n]),t._controlObjects[n].phrases.forEach(function(e){return t._trie.insert(e,n)})})}},{key:"trie",get:function(){return this._trie}},{key:"controlObjects",get:function(){return this._controlObjects}}])&&b(t.prototype,n),r&&b(t,r),e}();function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._recognizeResult=t,this._controlObject=n}var t,n,r;return t=e,(n=[{key:"actions",get:function(){return this._controlObject.event}},{key:"phrases",get:function(){return this._controlObject.phrases}},{key:"element",get:function(){return this._controlObject.domElement}},{key:"result",get:function(){return this._recognizeResult}},{key:"listener",get:function(){return this._controlObject.listener}}])&&_(t.prototype,n),r&&_(t,r),e}();function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"run",value:function(e,t){var n=new w(e,t);this.executeListener(n),this.executeEvents(n)}},{key:"_invoke",value:function(e,t){if(!("on"+e in t.element))throw new Error("VCL >> actions."+e+" event is not supported on element.");t.element.dispatchEvent(new Event(e,{bubbles:!0,cancelable:!1}))}},{key:"_performFunction",value:function(e,t,n){if("boolean"==typeof t)return t;if("function"==typeof t)return t(n);throw new Error("VCL >> actions."+e+" type of value is not recognized.")}},{key:"executeEvents",value:function(e){var t=this;Object.keys(e.actions).forEach(function(n){var r=t._performFunction(n,e.actions[n],e);if(r)t._invoke(n,e);else if("undefined"===r)throw new Error("VCL >> actions."+n+" value must return true or false.")})}},{key:"executeListener",value:function(e){if(e.listener){if("function"!=typeof e.listener)throw new Error("VCL >> type of listener value must be a function.");e.listener(e)}}}])&&m(t.prototype,n),r&&m(t,r),e}();function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._speechApi=new c(this._setApiConfig(t)),this._serviceObjects=new g(this._setServiceObjectsConfig(t)),this._runner=new k,this._logging=t.global.speechApi.debug,window.addEventListener("keydown",function(e){e.ctrlKey&&e.shiftKey&&"V"===e.key&&n.execute()})}var t,n,r;return t=e,(n=[{key:"_setApiConfig",value:function(e){if("object"===O(e)&&e.global&&e.global.speechApi)return e.global.speechApi;throw new Error("VCL >> global.speechApi is not configured.")}},{key:"_setServiceObjectsConfig",value:function(e){if("object"===O(e))return e;throw new Error("VCL >> No element configured for voice control.")}},{key:"execute",value:function(){var e=this;this._speechApi.dictate(),this._speechApi.result().then(function(t){e._logging&&console.log("VCL >> Recognize result : "+t);var n=e._searchSelector(t);if(!n)throw new Error("VCL >> Voice command does not match any phrase for the voice control element");e._runner.run(t,e._serviceObjects.controlObjects[n]),e._speechApi.stop()})}},{key:"_searchSelector",value:function(e){var t=this,n=void 0;if([function(e){return e},function(e){return e.toLowerCase()},function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}].some(function(r){var o=t._serviceObjects.trie.search(r(e));return!!o&&(n=o,!0)}),null!=n)return n}}])&&j(t.prototype,n),r&&j(t,r),e}();n.d(t,"VCL",function(){return C})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwaS9Hb29nbGVDbG91ZEFwaS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBpL1czQ0FwaS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBpL1NwZWVjaEFwaS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXhlcy90cmllL1RyaWVOb2RlLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleGVzL3RyaWUvVHJpZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29udHJvbC9Db250cm9sT2JqZWN0LmpzIiwid2VicGFjazovLy8uL3NyYy9jb250cm9sL1NlcnZpY2VPYmplY3RzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb250cm9sL1ZDTEV2ZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9jb250cm9sL1J1bm5lci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvVkNMLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkdvb2dsZUNsb3VkQXBpIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsIlczQ0FwaSIsImNvbmZpZyIsIlczQ0FwaV9jbGFzc0NhbGxDaGVjayIsIl9yZWNvZ25pdGlvbiIsIl9pbml0aWFsaXplIiwid2luZG93IiwiU3BlZWNoUmVjb2duaXRpb24iLCJ3ZWJraXRTcGVlY2hSZWNvZ25pdGlvbiIsImxhbmd1YWdlIiwibGFuZyIsInVuZGVmaW5lZCIsIm1heEFsdGVybmF0aXZlcyIsInN0YXJ0IiwiX3RoaXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm9ucmVzdWx0IiwiZXZlbnQiLCJzcGVlY2hUb1RleHQiLCJyZXN1bHRzIiwidHJhbnNjcmlwdCIsImlzRmluYWwiLCJzdG9wIiwiU3BlZWNoQXBpIiwiU3BlZWNoQXBpX2NsYXNzQ2FsbENoZWNrIiwiX3NwZWVjaEFwaSIsIl9zZXRBcGkiLCJXM0MiLCJFcnJvciIsImRpY3RhdGUiLCJyZXN1bHQiLCJUcmllTm9kZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInBhcmVudEtleSIsIlRyaWVOb2RlX2NsYXNzQ2FsbENoZWNrIiwiX3BhcmVudE5vZGUiLCJwYXJlbnQiLCJfcGFyZW50S2V5IiwiX2NoaWxkcmVuIiwiZGF0YSIsImlzRW5kT2ZXb3JkIiwid29yZCIsImtleXMiLCJjaGFyIiwiY2hpbGRyZW4iLCJ1cGRhdGUiLCJub2RlIiwiVHJpZSIsIlRyaWVfY2xhc3NDYWxsQ2hlY2siLCJfcm9vdCIsIl9sYXN0SW5kZXgiLCJfaW5zZXJ0V29yZCIsImN1cnJlbnROb2RlIiwid29yZEluZGV4IiwiX2dldE5leHRJbmRleCIsImNoYXJBdCIsImhhc0NoaWxkIiwiYWRkQ2hpbGQiLCJfc2VhcmNoTm9kZSIsImhhc0NoaWxkcmVuIiwiX2RlbGV0ZVdvcmQiLCJkZWxldGVDaGlsZCIsInBhdGgiLCJwdXNoIiwic3Vic3RyaW5nIiwiQ29udHJvbE9iamVjdCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250cm9sRWxlbWVudFZhbHVlIiwiQ29udHJvbE9iamVjdF9jbGFzc0NhbGxDaGVjayIsImRvbUVsZW1lbnQiLCJfc2V0RG9tRWxlbWVudCIsInBocmFzZXMiLCJfc2V0UGhyYXNlcyIsImFjdGlvbnMiLCJsaXN0ZW5lciIsImRvY3VtZW50IiwiQXJyYXkiLCJfc2ltcGxpZnkiLCJwaHJhc2VzV2l0aG91dEFjY2VudCIsIm1hcCIsInBocmFzZSIsIm5vcm1hbGl6ZSIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImFwcGx5IiwiU2VydmljZU9iamVjdHMiLCJTZXJ2aWNlT2JqZWN0c19jbGFzc0NhbGxDaGVjayIsIl9jb250cm9sT2JqZWN0cyIsIl90cmllIiwiZGl2aWRlQ29udHJvbE9iamVjdHMiLCJnbG9iYWwiLCJfcmVmIiwiX29iamVjdFNwcmVhZCIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllcyIsIl91bnNldEdsb2JhbENvbmZpZyIsImZvckVhY2giLCJpbnNlcnQiLCJWQ0xFdmVudCIsInJlY29nbml6ZVJlc3VsdCIsImNvbnRyb2xPYmplY3QiLCJWQ0xFdmVudF9jbGFzc0NhbGxDaGVjayIsIl9yZWNvZ25pemVSZXN1bHQiLCJfY29udHJvbE9iamVjdCIsIlJ1bm5lciIsIlJ1bm5lcl9jbGFzc0NhbGxDaGVjayIsInZjbEV2ZW50IiwiZXhlY3V0ZUxpc3RlbmVyIiwiZXhlY3V0ZUV2ZW50cyIsImVsZW1lbnQiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsIm5hbWVFdmVudCIsImZ1bmMiLCJmdW5jdGlvblBlcmZvcm1lZCIsIl9wZXJmb3JtRnVuY3Rpb24iLCJfaW52b2tlIiwiVkNMIiwiVkNMX2NsYXNzQ2FsbENoZWNrIiwiX3NldEFwaUNvbmZpZyIsIl9zZXJ2aWNlT2JqZWN0cyIsIl9zZXRTZXJ2aWNlT2JqZWN0c0NvbmZpZyIsIl9ydW5uZXIiLCJfbG9nZ2luZyIsInNwZWVjaEFwaSIsImRlYnVnIiwiYWRkRXZlbnRMaXN0ZW5lciIsImN0cmxLZXkiLCJzaGlmdEtleSIsImV4ZWN1dGUiLCJfdHlwZW9mIiwiX3RoaXMyIiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJyZWNvZ25pemVTZWxlY3RvciIsIl9zZWFyY2hTZWxlY3RvciIsInJ1biIsImNvbnRyb2xPYmplY3RzIiwiX3RoaXMzIiwic29tZSIsIm1vZGlmaWVyIiwiZmluZCIsInRyaWUiLCJzZWFyY2giLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwiVkNMX1ZDTCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEVBQUEsQ0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLFlBQUEsQ0FBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURtQixPQUFBLEtBUWpEckIsRUFBQXNCLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxHQURBLEVBQUFBLElBQUFGLEVBQUFyQixFQUFBcUIsSUFDQSxFQUFBRSxFQUFBLE9BQUFGLEVBQ0EsS0FBQUUsR0FBQSxpQkFBQUYsUUFBQUcsV0FBQSxPQUFBSCxFQUNBLElBQUFJLEVBQUFYLE9BQUFZLE9BQUEsTUFHQSxHQUZBMUIsRUFBQWtCLEVBQUFPLEdBQ0FYLE9BQUFDLGVBQUFVLEVBQUEsV0FBeUNULFlBQUEsRUFBQUssVUFDekMsRUFBQUUsR0FBQSxpQkFBQUYsRUFBQSxRQUFBTSxLQUFBTixFQUFBckIsRUFBQVUsRUFBQWUsRUFBQUUsRUFBQSxTQUFBQSxHQUFnSCxPQUFBTixFQUFBTSxJQUFx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dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgR29vZ2xlQ2xvdWRBcGkge1xyXG4gICAgY29uc3RydWN0b3IoKSB7fVxyXG5cclxuICAgIGRpY3RhdGUoKSB7fVxyXG5cclxuICAgIHJlc3VsdCgpIHt9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBXM0NBcGkge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgICAgIHRoaXMuX3JlY29nbml0aW9uID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9pbml0aWFsaXplKGNvbmZpZyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2luaXRpYWxpemUoY29uZmlnKSB7XHJcbiAgICAgICAgd2luZG93LlNwZWVjaFJlY29nbml0aW9uID0gd2luZG93LndlYmtpdFNwZWVjaFJlY29nbml0aW9uIHx8IHdpbmRvdy5TcGVlY2hSZWNvZ25pdGlvbjtcclxuICAgICAgICB0aGlzLl9yZWNvZ25pdGlvbiA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbigpO1xyXG4gICAgICAgIHRoaXMuX3JlY29nbml0aW9uLmxhbmd1YWdlID0gY29uZmlnLmxhbmcgPyBjb25maWcubGFuZyA6IHVuZGVmaW5lZDtcclxuICAgICAgICAvLyB0aGlzLl9yZWNvZ25pdGlvbi5jb250aW51b3VzID0gY29uZmlnLmNvbnRpbnVvdXMgPyBjb25maWcuY29udGludW91cyA6IGZhbHNlO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlY29nbml0aW9uLmludGVyaW1SZXN1bHRzID0gY29uZmlnLmludGVyaW1SZXN1bHRzID8gY29uZmlnLmludGVyaW1SZXN1bHRzIDogdHJ1ZTtcclxuICAgICAgICB0aGlzLl9yZWNvZ25pdGlvbi5tYXhBbHRlcm5hdGl2ZXMgPSBjb25maWcubWF4QWx0ZXJuYXRpdmVzID8gY29uZmlnLm1heEFsdGVybmF0aXZlcyA6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgZGljdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLl9yZWNvZ25pdGlvbi5zdGFydCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc3VsdCgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVjb2duaXRpb24ub25yZXN1bHQgPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFRvVGV4dCA9IGV2ZW50LnJlc3VsdHNbMF1bMF0udHJhbnNjcmlwdDtcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC5yZXN1bHRzWzBdLmlzRmluYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNwZWVjaFRvVGV4dClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHN0b3AoKSB7XHJcbiAgICAgICAgdGhpcy5fcmVjb2duaXRpb24uc3RvcCgpO1xyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCBHb29nbGVDbG91ZEFwaSBmcm9tIFwiLi9Hb29nbGVDbG91ZEFwaVwiO1xyXG5pbXBvcnQgVzNDQXBpIGZyb20gXCIuL1czQ0FwaVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3BlZWNoQXBpIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcclxuICAgICAgICB0aGlzLl9zcGVlY2hBcGkgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3NldEFwaShjb25maWcpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRBcGkoY29uZmlnKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5XM0MpIHtcclxuICAgICAgICAgICAgdGhpcy5fc3BlZWNoQXBpID0gbmV3IFczQ0FwaShjb25maWcuVzNDKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5Hb29nbGVDbG91ZEFwaSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zcGVlY2hBcGkgPSBuZXcgR29vZ2xlQ2xvdWRBcGkoY29uZmlnLkdvb2dsZUNsb3VkQXBpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lzIG5vdCBzZXQgYW55IGdsb2JhbC5zcGVlY2hBcGkgY29uZmlndXJhdGlvbicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBkaWN0YXRlKCkge1xyXG4gICAgICAgIHRoaXMuX3NwZWVjaEFwaS5kaWN0YXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzdWx0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zcGVlY2hBcGkucmVzdWx0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RvcCgpIHtcclxuICAgICAgICB0aGlzLl9zcGVlY2hBcGkuc3RvcCgpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJpZU5vZGUge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBhcmVudE5vZGUgPSBudWxsLCBwYXJlbnRLZXkgPSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5fcGFyZW50Tm9kZSA9IHBhcmVudDtcclxuICAgICAgICB0aGlzLl9wYXJlbnRLZXkgPSBwYXJlbnRLZXk7XHJcbiAgICAgICAgdGhpcy5fY2hpbGRyZW4gPSB7fTtcclxuICAgICAgICB0aGlzLmRhdGEgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNFbmRPZldvcmQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLndvcmQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBwYXJlbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAga2V5OiB0aGlzLl9wYXJlbnRLZXksXHJcbiAgICAgICAgICAgIG5vZGU6IHRoaXMuX3BhcmVudE5vZGVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBjaGlsZHJlbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKGRhdGEpIHtcclxuICAgICAgICB0aGlzLmlzRW5kT2ZXb3JkID0gISFkYXRhO1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLmlzRW5kT2ZXb3JkKVxyXG4gICAgICAgICAgICB0aGlzLndvcmQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGhhc0NoaWxkcmVuKCkge1xyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9jaGlsZHJlbikubGVuZ3RoID4gMDtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDaGlsZChjaGFyKSB7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbltjaGFyXS51cGRhdGUobnVsbCk7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbltjaGFyXS5fcGFyZW50Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbltjaGFyXS5fcGFyZW50S2V5ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuW2NoYXJdLndvcmQgPSBudWxsO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9jaGlsZHJlbltjaGFyXTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRDaGlsZChjaGFyLCBub2RlKSB7XHJcbiAgICAgICAgdGhpcy5fY2hpbGRyZW5bY2hhcl0gPSBub2RlO1xyXG4gICAgfVxyXG5cclxuICAgIGhhc0NoaWxkKGNoYXIpIHtcclxuICAgICAgICByZXR1cm4gISF0aGlzLl9jaGlsZHJlbltjaGFyXTtcclxuICAgIH1cclxufSIsImltcG9ydCBUcmllTm9kZSBmcm9tIFwiLi9UcmllTm9kZS5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJpZSB7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuX3Jvb3QgPSBuZXcgVHJpZU5vZGUoKTtcclxuICAgICAgICB0aGlzLl9sYXN0SW5kZXggPSAxO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCByb290KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yb290O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5zZXJ0IHdvcmQgdG8gdGhlIFRyaWUgYW5kIG1hcCBkYXRhIG9uIHRoZSB3b3JkLlxyXG4gICAgICogSWYgZGF0YSBpcyBub3QgcHJvdmlkZWQgaXQgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYXMgYW4gaW5jcmVhc2luZyBudW1iZXIuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ313b3JkXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH1bZGF0YV1cclxuICAgICAqL1xyXG4gICAgaW5zZXJ0KHdvcmQsIGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5zZXJ0V29yZCh3b3JkLCBkYXRhLCB0aGlzLl9yb290LCAwKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ313b3JkXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH1kYXRhXHJcbiAgICAgKiBAcGFyYW0ge1RyaWVOb2RlfWN1cnJlbnROb2RlXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn13b3JkSW5kZXhcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9pbnNlcnRXb3JkKHdvcmQsIGRhdGEsIGN1cnJlbnROb2RlLCB3b3JkSW5kZXgpIHtcclxuICAgICAgICBpZiAod29yZEluZGV4ID09PSB3b3JkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjdXJyZW50Tm9kZS53b3JkID0gd29yZDtcclxuICAgICAgICAgICAgY3VycmVudE5vZGUudXBkYXRlKGRhdGEgfHwgdGhpcy5fZ2V0TmV4dEluZGV4KCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjID0gd29yZC5jaGFyQXQod29yZEluZGV4KTtcclxuICAgICAgICBpZiAoIWN1cnJlbnROb2RlLmhhc0NoaWxkKGMpKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnROb2RlLmFkZENoaWxkKGMsIG5ldyBUcmllTm9kZShjdXJyZW50Tm9kZSwgYykpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnNlcnRXb3JkKHdvcmQsIGRhdGEsIGN1cnJlbnROb2RlLmNoaWxkcmVuW2NdLCB3b3JkSW5kZXggKyAxKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNlYXJjaGluZyBUcmllIGZvciBkYXRhIGluZGV4ZWQgYnkgdGhlIHByb3ZpZGVkIHdvcmQuXHJcbiAgICAgKiBJZiB0aGUgd29yZCBpcyBpbiB0aGUgVHJpZSBhIGRhdGEgb2JqZWN0IGlzIHJldHVybmVkLlxyXG4gICAgICogSWYgdGhlIHdvcmQgaXMgbm90IGZvdW5kIGluIHRoZSBUcmllIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ313b3JkXHJcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0IHwgbnVsbH1cclxuICAgICAqL1xyXG4gICAgc2VhcmNoKHdvcmQpIHtcclxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5fc2VhcmNoTm9kZSh3b3JkLCB0aGlzLl9yb290LCAwKTtcclxuICAgICAgICByZXR1cm4gIW5vZGUgPyBudWxsIDogbm9kZS5kYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGluZGV4IG5vZGUgZm9yIHRoZSB3b3JkLlxyXG4gICAgICogSWYgdGhlIHdvcmQgaXMgbm90IGluIHRoZSBUcmllIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ313b3JkXHJcbiAgICAgKiBAcGFyYW0ge1RyaWVOb2RlfWN1cnJlbnROb2RlXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn13b3JkSW5kZXhcclxuICAgICAqIEByZXR1cm5zIHtUcmllTm9kZSB8IG51bGx9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfc2VhcmNoTm9kZSh3b3JkLCBjdXJyZW50Tm9kZSwgd29yZEluZGV4KSB7XHJcbiAgICAgICAgaWYgKHdvcmRJbmRleCA9PT0gd29yZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLmlzRW5kT2ZXb3JkID8gY3VycmVudE5vZGUgOiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGMgPSB3b3JkLmNoYXJBdCh3b3JkSW5kZXgpO1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50Tm9kZS5oYXNDaGlsZChjKSA/IHRoaXMuX3NlYXJjaE5vZGUod29yZCwgY3VycmVudE5vZGUuY2hpbGRyZW5bY10sIHdvcmRJbmRleCArIDEpIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlbGV0ZSB3b3JkIGZyb20gdGhlIFRyaWUuXHJcbiAgICAgKiBJZiB0aGUgd29yZCBpcyBub3QgaW4gdGhlIFRyaWUgZmFsc2UgaXMgcmV0dXJuZWQgb3RoZXJ3aXNlIHRydWUuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ313b3JkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgZGVsZXRlKHdvcmQpIHtcclxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5fc2VhcmNoTm9kZSh3b3JkLCB0aGlzLl9yb290LCAwKTtcclxuICAgICAgICBpZiAoIW5vZGUpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKG5vZGUuaGFzQ2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICBub2RlLnVwZGF0ZShudWxsKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9kZWxldGVXb3JkKG5vZGUpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIF9kZWxldGVXb3JkKGN1cnJlbnROb2RlKSB7XHJcbiAgICAgICAgaWYgKGN1cnJlbnROb2RlID09PSB0aGlzLl9yb290KVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgY29uc3QgcGFyZW50ID0gY3VycmVudE5vZGUucGFyZW50O1xyXG5cclxuICAgICAgICAvLyBpZihjdXJyZW50Tm9kZS5wYXJlbnRLZXkgPT09IHdvcmQuY2hhckF0KHdvcmRJbmRleCkpXHJcblxyXG4gICAgICAgIHBhcmVudC5ub2RlLmRlbGV0ZUNoaWxkKHBhcmVudC5rZXkpO1xyXG4gICAgICAgIGlmIChwYXJlbnQubm9kZS5oYXNDaGlsZHJlbigpKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlV29yZChwYXJlbnQubm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKHdvcmQsIGRhdGEpIHtcclxuICAgICAgICBjb25zdCBub2RlID0gdGhpcy5fc2VhcmNoTm9kZSh3b3JkLCB0aGlzLl9yb290LCAwKTtcclxuICAgICAgICBpZiAoIW5vZGUpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgbm9kZS51cGRhdGUoZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0YU5vZGUod29yZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZWFyY2hOb2RlKHdvcmQsIHRoaXMuX3Jvb3QsIDApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFBhdGgod29yZCkge1xyXG4gICAgICAgIGNvbnN0IHBhdGggPSBbXTtcclxuICAgICAgICBwYXRoLnB1c2godGhpcy5fcm9vdCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHdvcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgcGF0aC5wdXNoKHRoaXMuX3NlYXJjaE5vZGUod29yZC5zdWJzdHJpbmcoMCwgaSksIHRoaXMuX3Jvb3QsIDApKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXROZXh0SW5kZXgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xhc3RJbmRleCsrO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29udHJvbE9iamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihxdWVyeVNlbGVjdG9yLCBjb250cm9sRWxlbWVudFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yID0gcXVlcnlTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLmRvbUVsZW1lbnQgPSB0aGlzLl9zZXREb21FbGVtZW50KHF1ZXJ5U2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMucGhyYXNlcyA9IHRoaXMuX3NldFBocmFzZXMoY29udHJvbEVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgdGhpcy5ldmVudCA9IGNvbnRyb2xFbGVtZW50VmFsdWUuYWN0aW9ucztcclxuICAgICAgICB0aGlzLmxpc3RlbmVyID0gY29udHJvbEVsZW1lbnRWYWx1ZS5saXN0ZW5lcjtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RG9tRWxlbWVudChxdWVyeVNlbGVjdG9yKSB7XHJcbiAgICAgICAgY29uc3QgZG9tRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocXVlcnlTZWxlY3Rvcik7XHJcbiAgICAgICAgaWYgKGRvbUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRvbUVsZW1lbnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWQ0wgPj4gRWxlbWVudCAnICsgcXVlcnlTZWxlY3RvciArICcgbm90IGZvdW5kIG9uIHRoZSBwYWdlLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfc2V0UGhyYXNlcyhjb250cm9sRWxlbWVudFZhbHVlKSB7XHJcbiAgICAgICAgaWYgKGNvbnRyb2xFbGVtZW50VmFsdWUucGhyYXNlcyBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zaW1wbGlmeShjb250cm9sRWxlbWVudFZhbHVlLnBocmFzZXMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVkNMID4+IHBocmFzZXMgZm9yICcgKyB0aGlzLnF1ZXJ5U2VsZWN0b3IgKyAnIGlzIG5vdCBjb25maWd1cmVkLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfc2ltcGxpZnkocGhyYXNlcykge1xyXG4gICAgICAgIGNvbnN0IHBocmFzZXNXaXRob3V0QWNjZW50ID0gcGhyYXNlcy5tYXAocGhyYXNlID0+IHBocmFzZS5ub3JtYWxpemUoJ05GRCcpLnJlcGxhY2UoL1tcXHUwMzAwLVxcdTAzNmZdL2csIFwiXCIpLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHBocmFzZXMsIHBocmFzZXNXaXRob3V0QWNjZW50KTtcclxuICAgICAgICByZXR1cm4gcGhyYXNlcztcclxuICAgIH1cclxufSIsImltcG9ydCBUcmllIGZyb20gXCIuLi9pbmRleGVzL3RyaWUvVHJpZVwiO1xyXG5pbXBvcnQgQ29udHJvbE9iamVjdCBmcm9tIFwiLi9Db250cm9sT2JqZWN0XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXJ2aWNlT2JqZWN0cyB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5fY29udHJvbE9iamVjdHMgPSB7fTtcclxuICAgICAgICB0aGlzLl90cmllID0gbmV3IFRyaWUoKTtcclxuICAgICAgICB0aGlzLmRpdmlkZUNvbnRyb2xPYmplY3RzKGNvbmZpZyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHRyaWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyaWU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGNvbnRyb2xPYmplY3RzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb250cm9sT2JqZWN0cztcclxuICAgIH1cclxuXHJcblxyXG4gICAgX3Vuc2V0R2xvYmFsQ29uZmlnKGNvbmZpZykge1xyXG4gICAgICAgIGlmIChjb25maWcuZ2xvYmFsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoKHtnbG9iYWwsIC4uLm90aGVyc30pID0+ICh7Li4ub3RoZXJzfSkpKGNvbmZpZyk7XHJcbiAgICAgICAgfSBlbHNlIHJldHVybiBjb25maWc7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGRpdmlkZUNvbnRyb2xPYmplY3RzKGNvbmZpZykge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuX3Vuc2V0R2xvYmFsQ29uZmlnKGNvbmZpZykpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY29udHJvbE9iamVjdHNba2V5XSA9IG5ldyBDb250cm9sT2JqZWN0KGtleSxjb25maWdba2V5XSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xPYmplY3RzW2tleV0ucGhyYXNlcy5mb3JFYWNoKHBocmFzZSA9PiB0aGlzLl90cmllLmluc2VydChwaHJhc2UsIGtleSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFZDTEV2ZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHJlY29nbml6ZVJlc3VsdCwgY29udHJvbE9iamVjdCkge1xyXG4gICAgICAgIHRoaXMuX3JlY29nbml6ZVJlc3VsdCA9IHJlY29nbml6ZVJlc3VsdDtcclxuICAgICAgICB0aGlzLl9jb250cm9sT2JqZWN0ID0gY29udHJvbE9iamVjdDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgYWN0aW9ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29udHJvbE9iamVjdC5ldmVudDtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgcGhyYXNlcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29udHJvbE9iamVjdC5waHJhc2VzO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBlbGVtZW50KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb250cm9sT2JqZWN0LmRvbUVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHJlc3VsdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVjb2duaXplUmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBsaXN0ZW5lcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29udHJvbE9iamVjdC5saXN0ZW5lcjtcclxuICAgIH1cclxuXHJcblxyXG5cclxufSIsImltcG9ydCBWQ0xFdmVudCBmcm9tIFwiLi9WQ0xFdmVudFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUnVubmVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gICAgcnVuKHJlY29nbml6ZVJlc3VsdCwgY29udHJvbE9iamVjdCkge1xyXG4gICAgICAgIGNvbnN0IHZjbEV2ZW50ID0gbmV3IFZDTEV2ZW50KHJlY29nbml6ZVJlc3VsdCwgY29udHJvbE9iamVjdCk7XHJcbiAgICAgICAgdGhpcy5leGVjdXRlTGlzdGVuZXIodmNsRXZlbnQpO1xyXG4gICAgICAgIHRoaXMuZXhlY3V0ZUV2ZW50cyh2Y2xFdmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2ludm9rZShldmVudCwgdmNsRXZlbnQpIHtcclxuICAgICAgICBpZiAoJ29uJyArIGV2ZW50IGluIHZjbEV2ZW50LmVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdmNsRXZlbnQuZWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChldmVudCwge1wiYnViYmxlc1wiOiB0cnVlLCBcImNhbmNlbGFibGVcIjogZmFsc2V9KSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWQ0wgPj4gYWN0aW9ucy4nICsgZXZlbnQgKyAnIGV2ZW50IGlzIG5vdCBzdXBwb3J0ZWQgb24gZWxlbWVudC4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3BlcmZvcm1GdW5jdGlvbihuYW1lRXZlbnQsIGZ1bmMsIHZjbEV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmM7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZnVuYyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuYyh2Y2xFdmVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWQ0wgPj4gYWN0aW9ucy4nICsgbmFtZUV2ZW50ICsgJyB0eXBlIG9mIHZhbHVlIGlzIG5vdCByZWNvZ25pemVkLicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBleGVjdXRlRXZlbnRzKHZjbEV2ZW50KSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXModmNsRXZlbnQuYWN0aW9ucykuZm9yRWFjaChldmVudCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uUGVyZm9ybWVkID0gdGhpcy5fcGVyZm9ybUZ1bmN0aW9uKGV2ZW50LCB2Y2xFdmVudC5hY3Rpb25zW2V2ZW50XSwgdmNsRXZlbnQpO1xyXG4gICAgICAgICAgICBpZiAoZnVuY3Rpb25QZXJmb3JtZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ludm9rZShldmVudCwgdmNsRXZlbnQpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZ1bmN0aW9uUGVyZm9ybWVkID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWQ0wgPj4gYWN0aW9ucy4nICsgZXZlbnQgKyAnIHZhbHVlIG11c3QgcmV0dXJuIHRydWUgb3IgZmFsc2UuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBleGVjdXRlTGlzdGVuZXIodmNsRXZlbnQpIHtcclxuICAgICAgICBpZiAodmNsRXZlbnQubGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2Y2xFdmVudC5saXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgdmNsRXZlbnQubGlzdGVuZXIodmNsRXZlbnQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWQ0wgPj4gdHlwZSBvZiBsaXN0ZW5lciB2YWx1ZSBtdXN0IGJlIGEgZnVuY3Rpb24uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge1NwZWVjaEFwaX0gZnJvbSBcIi4vYXBpL2luZGV4XCI7XHJcbmltcG9ydCBTZXJ2aWNlT2JqZWN0cyBmcm9tIFwiLi9jb250cm9sL1NlcnZpY2VPYmplY3RzXCI7XHJcbmltcG9ydCBSdW5uZXIgZnJvbSBcIi4vY29udHJvbC9SdW5uZXJcIjtcclxuXHJcbi8qKlxyXG4gKiBAY2xhc3NcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZDTCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5fc3BlZWNoQXBpID0gbmV3IFNwZWVjaEFwaSh0aGlzLl9zZXRBcGlDb25maWcoY29uZmlnKSk7XHJcbiAgICAgICAgdGhpcy5fc2VydmljZU9iamVjdHMgPSBuZXcgU2VydmljZU9iamVjdHModGhpcy5fc2V0U2VydmljZU9iamVjdHNDb25maWcoY29uZmlnKSk7XHJcbiAgICAgICAgdGhpcy5fcnVubmVyID0gbmV3IFJ1bm5lcigpO1xyXG4gICAgICAgIHRoaXMuX2xvZ2dpbmcgPSBjb25maWcuZ2xvYmFsLnNwZWVjaEFwaS5kZWJ1ZztcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChrZXkuY3RybEtleSAmJiBrZXkuc2hpZnRLZXkgJiYga2V5LmtleSA9PT0gJ1YnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRBcGlDb25maWcoY29uZmlnKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnICYmIGNvbmZpZy5nbG9iYWwgJiYgY29uZmlnLmdsb2JhbC5zcGVlY2hBcGkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy5nbG9iYWwuc3BlZWNoQXBpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVkNMID4+IGdsb2JhbC5zcGVlY2hBcGkgaXMgbm90IGNvbmZpZ3VyZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zZXRTZXJ2aWNlT2JqZWN0c0NvbmZpZyhjb25maWcpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZDTCA+PiBObyBlbGVtZW50IGNvbmZpZ3VyZWQgZm9yIHZvaWNlIGNvbnRyb2wuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlcm9mIFZDTCNcclxuICAgICAqL1xyXG4gICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICB0aGlzLl9zcGVlY2hBcGkuZGljdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3NwZWVjaEFwaS5yZXN1bHQoKVxyXG4gICAgICAgICAgICAudGhlbihyZWNvZ25pemVSZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xvZ2dpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVkNMID4+IFJlY29nbml6ZSByZXN1bHQgOiAnICsgcmVjb2duaXplUmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlY29nbml6ZVNlbGVjdG9yID0gdGhpcy5fc2VhcmNoU2VsZWN0b3IocmVjb2duaXplUmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIGlmIChyZWNvZ25pemVTZWxlY3Rvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3J1bm5lci5ydW4ocmVjb2duaXplUmVzdWx0LCB0aGlzLl9zZXJ2aWNlT2JqZWN0cy5jb250cm9sT2JqZWN0c1tyZWNvZ25pemVTZWxlY3Rvcl0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZDTCA+PiBWb2ljZSBjb21tYW5kIGRvZXMgbm90IG1hdGNoIGFueSBwaHJhc2UgZm9yIHRoZSB2b2ljZSBjb250cm9sIGVsZW1lbnQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3NwZWVjaEFwaS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZWFyY2hTZWxlY3RvcihyZWNvZ25pemVSZXN1bHQpIHtcclxuICAgICAgICBjb25zdCBtb2RpZmllcnMgPSBbcGhyYXNlID0+IHBocmFzZSwgcGhyYXNlID0+IHBocmFzZS50b0xvd2VyQ2FzZSgpLCBwaHJhc2UgPT4gcGhyYXNlLm5vcm1hbGl6ZSgnTkZEJykucmVwbGFjZSgvW1xcdTAzMDAtXFx1MDM2Zl0vZywgXCJcIikudG9Mb3dlckNhc2UoKV07XHJcbiAgICAgICAgbGV0IHJlY29nbml6ZVNlbGVjdG9yID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIG1vZGlmaWVycy5zb21lKG1vZGlmaWVyID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZmluZCA9IHRoaXMuX3NlcnZpY2VPYmplY3RzLnRyaWUuc2VhcmNoKG1vZGlmaWVyKHJlY29nbml6ZVJlc3VsdCkpO1xyXG4gICAgICAgICAgICBpZihmaW5kKXtcclxuICAgICAgICAgICAgICAgIHJlY29nbml6ZVNlbGVjdG9yID0gZmluZDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAocmVjb2duaXplU2VsZWN0b3IgIT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuIHJlY29nbml6ZVNlbGVjdG9yO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IHtkZWZhdWx0IGFzIFZDTH0gZnJvbSBcIi4vVkNMXCI7Il0sInNvdXJjZVJvb3QiOiIifQ==